/**
 * This file was auto-generated by Fern from our API Definition.
 */

import { mockServerPool } from "../mock-server/MockServerPool";
import { AirweaveSDKClient } from "../../src/Client";
import * as AirweaveSDK from "../../src/api/index";

describe("SourceConnections", () => {
    test("list (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = [
            {
                id: "550e8400-e29b-41d4-a716-446655440000",
                name: "GitHub Docs Repo",
                short_name: "github",
                readable_collection_id: "documentation-ab123",
                created_at: "2024-03-15T09:30:00Z",
                modified_at: "2024-03-15T14:22:15Z",
                is_authenticated: true,
                entity_count: 1250,
                federated_search: false,
                auth_method: "direct",
                status: "active",
            },
        ];
        server
            .mockEndpoint()
            .get("/source-connections")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.sourceConnections.list({
            collection: "collection",
            skip: 0,
            limit: 100,
        });
        expect(response).toEqual([
            {
                id: "550e8400-e29b-41d4-a716-446655440000",
                name: "GitHub Docs Repo",
                short_name: "github",
                readable_collection_id: "documentation-ab123",
                created_at: "2024-03-15T09:30:00Z",
                modified_at: "2024-03-15T14:22:15Z",
                is_authenticated: true,
                entity_count: 1250,
                federated_search: false,
                auth_method: "direct",
                status: "active",
            },
        ]);
    });

    test("list (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .get("/source-connections")
            .respondWith()
            .statusCode(422)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.list();
        }).rejects.toThrow(AirweaveSDK.UnprocessableEntityError);
    });

    test("list (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .get("/source-connections")
            .respondWith()
            .statusCode(429)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.list();
        }).rejects.toThrow(AirweaveSDK.TooManyRequestsError);
    });

    test("create (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { short_name: "github", readable_collection_id: "customer-support-tickets-x7k9m" };
        const rawResponseBody = {
            id: "550e8400-e29b-41d4-a716-446655440000",
            organization_id: "123e4567-e89b-12d3-a456-426614174000",
            name: "GitHub Docs Repo",
            description: "Main documentation repository",
            short_name: "github",
            readable_collection_id: "documentation-ab123",
            status: "active",
            created_at: "2024-03-15T09:30:00Z",
            modified_at: "2024-03-15T14:22:15Z",
            auth: {
                method: "direct",
                authenticated: true,
                authenticated_at: "2024-03-15T09:30:00Z",
                expires_at: "2024-01-15T09:30:00Z",
                auth_url: "auth_url",
                auth_url_expires: "2024-01-15T09:30:00Z",
                redirect_url: "redirect_url",
                provider_readable_id: "provider_readable_id",
                provider_id: "provider_id",
            },
            config: { branch: "main", repo_name: "company/docs" },
            schedule: {
                cron: "0 */6 * * *",
                next_run: "2024-03-15T18:00:00Z",
                continuous: true,
                cursor_field: "cursor_field",
                cursor_value: { key: "value" },
            },
            sync: {
                total_runs: 15,
                successful_runs: 14,
                failed_runs: 1,
                last_job: {
                    id: "770e8400-e29b-41d4-a716-446655440002",
                    status: "created",
                    started_at: "2024-03-15T12:00:00Z",
                    completed_at: "2024-03-15T12:05:32Z",
                    duration_seconds: 332,
                    entities_inserted: 45,
                    entities_updated: 12,
                    entities_deleted: 1,
                    entities_failed: 1,
                    error: "error",
                },
            },
            sync_id: "sync_id",
            entities: { total_entities: 1250, by_type: { file: { count: 1250 } } },
            federated_search: false,
        };
        server
            .mockEndpoint()
            .post("/source-connections")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.sourceConnections.create({
            short_name: "github",
            readable_collection_id: "customer-support-tickets-x7k9m",
        });
        expect(response).toEqual({
            id: "550e8400-e29b-41d4-a716-446655440000",
            organization_id: "123e4567-e89b-12d3-a456-426614174000",
            name: "GitHub Docs Repo",
            description: "Main documentation repository",
            short_name: "github",
            readable_collection_id: "documentation-ab123",
            status: "active",
            created_at: "2024-03-15T09:30:00Z",
            modified_at: "2024-03-15T14:22:15Z",
            auth: {
                method: "direct",
                authenticated: true,
                authenticated_at: "2024-03-15T09:30:00Z",
                expires_at: "2024-01-15T09:30:00Z",
                auth_url: "auth_url",
                auth_url_expires: "2024-01-15T09:30:00Z",
                redirect_url: "redirect_url",
                provider_readable_id: "provider_readable_id",
                provider_id: "provider_id",
            },
            config: {
                branch: "main",
                repo_name: "company/docs",
            },
            schedule: {
                cron: "0 */6 * * *",
                next_run: "2024-03-15T18:00:00Z",
                continuous: true,
                cursor_field: "cursor_field",
                cursor_value: {
                    key: "value",
                },
            },
            sync: {
                total_runs: 15,
                successful_runs: 14,
                failed_runs: 1,
                last_job: {
                    id: "770e8400-e29b-41d4-a716-446655440002",
                    status: "created",
                    started_at: "2024-03-15T12:00:00Z",
                    completed_at: "2024-03-15T12:05:32Z",
                    duration_seconds: 332,
                    entities_inserted: 45,
                    entities_updated: 12,
                    entities_deleted: 1,
                    entities_failed: 1,
                    error: "error",
                },
            },
            sync_id: "sync_id",
            entities: {
                total_entities: 1250,
                by_type: {
                    file: {
                        count: 1250,
                    },
                },
            },
            federated_search: false,
        });
    });

    test("create (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {
            name: undefined,
            short_name: "short_name",
            readable_collection_id: "readable_collection_id",
            description: undefined,
            config: undefined,
            schedule: undefined,
            sync_immediately: undefined,
            authentication: undefined,
            redirect_url: undefined,
        };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/source-connections")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(422)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.create({
                name: undefined,
                short_name: "short_name",
                readable_collection_id: "readable_collection_id",
                description: undefined,
                config: undefined,
                schedule: undefined,
                sync_immediately: undefined,
                authentication: undefined,
                redirect_url: undefined,
            });
        }).rejects.toThrow(AirweaveSDK.UnprocessableEntityError);
    });

    test("create (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {
            name: undefined,
            short_name: "short_name",
            readable_collection_id: "readable_collection_id",
            description: undefined,
            config: undefined,
            schedule: undefined,
            sync_immediately: undefined,
            authentication: undefined,
            redirect_url: undefined,
        };
        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .post("/source-connections")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(429)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.create({
                name: undefined,
                short_name: "short_name",
                readable_collection_id: "readable_collection_id",
                description: undefined,
                config: undefined,
                schedule: undefined,
                sync_immediately: undefined,
                authentication: undefined,
                redirect_url: undefined,
            });
        }).rejects.toThrow(AirweaveSDK.TooManyRequestsError);
    });

    test("get (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            id: "550e8400-e29b-41d4-a716-446655440000",
            organization_id: "123e4567-e89b-12d3-a456-426614174000",
            name: "GitHub Docs Repo",
            description: "Main documentation repository",
            short_name: "github",
            readable_collection_id: "documentation-ab123",
            status: "active",
            created_at: "2024-03-15T09:30:00Z",
            modified_at: "2024-03-15T14:22:15Z",
            auth: {
                method: "direct",
                authenticated: true,
                authenticated_at: "2024-03-15T09:30:00Z",
                expires_at: "2024-01-15T09:30:00Z",
                auth_url: "auth_url",
                auth_url_expires: "2024-01-15T09:30:00Z",
                redirect_url: "redirect_url",
                provider_readable_id: "provider_readable_id",
                provider_id: "provider_id",
            },
            config: { branch: "main", repo_name: "company/docs" },
            schedule: {
                cron: "0 */6 * * *",
                next_run: "2024-03-15T18:00:00Z",
                continuous: true,
                cursor_field: "cursor_field",
                cursor_value: { key: "value" },
            },
            sync: {
                total_runs: 15,
                successful_runs: 14,
                failed_runs: 1,
                last_job: {
                    id: "770e8400-e29b-41d4-a716-446655440002",
                    status: "created",
                    started_at: "2024-03-15T12:00:00Z",
                    completed_at: "2024-03-15T12:05:32Z",
                    duration_seconds: 332,
                    entities_inserted: 45,
                    entities_updated: 12,
                    entities_deleted: 1,
                    entities_failed: 1,
                    error: "error",
                },
            },
            sync_id: "sync_id",
            entities: { total_entities: 1250, by_type: { file: { count: 1250 } } },
            federated_search: false,
        };
        server
            .mockEndpoint()
            .get("/source-connections/550e8400-e29b-41d4-a716-446655440000")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.sourceConnections.get("550e8400-e29b-41d4-a716-446655440000");
        expect(response).toEqual({
            id: "550e8400-e29b-41d4-a716-446655440000",
            organization_id: "123e4567-e89b-12d3-a456-426614174000",
            name: "GitHub Docs Repo",
            description: "Main documentation repository",
            short_name: "github",
            readable_collection_id: "documentation-ab123",
            status: "active",
            created_at: "2024-03-15T09:30:00Z",
            modified_at: "2024-03-15T14:22:15Z",
            auth: {
                method: "direct",
                authenticated: true,
                authenticated_at: "2024-03-15T09:30:00Z",
                expires_at: "2024-01-15T09:30:00Z",
                auth_url: "auth_url",
                auth_url_expires: "2024-01-15T09:30:00Z",
                redirect_url: "redirect_url",
                provider_readable_id: "provider_readable_id",
                provider_id: "provider_id",
            },
            config: {
                branch: "main",
                repo_name: "company/docs",
            },
            schedule: {
                cron: "0 */6 * * *",
                next_run: "2024-03-15T18:00:00Z",
                continuous: true,
                cursor_field: "cursor_field",
                cursor_value: {
                    key: "value",
                },
            },
            sync: {
                total_runs: 15,
                successful_runs: 14,
                failed_runs: 1,
                last_job: {
                    id: "770e8400-e29b-41d4-a716-446655440002",
                    status: "created",
                    started_at: "2024-03-15T12:00:00Z",
                    completed_at: "2024-03-15T12:05:32Z",
                    duration_seconds: 332,
                    entities_inserted: 45,
                    entities_updated: 12,
                    entities_deleted: 1,
                    entities_failed: 1,
                    error: "error",
                },
            },
            sync_id: "sync_id",
            entities: {
                total_entities: 1250,
                by_type: {
                    file: {
                        count: 1250,
                    },
                },
            },
            federated_search: false,
        });
    });

    test("get (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .get("/source-connections/source_connection_id")
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.get("source_connection_id");
        }).rejects.toThrow(AirweaveSDK.NotFoundError);
    });

    test("get (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .get("/source-connections/source_connection_id")
            .respondWith()
            .statusCode(422)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.get("source_connection_id");
        }).rejects.toThrow(AirweaveSDK.UnprocessableEntityError);
    });

    test("get (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .get("/source-connections/source_connection_id")
            .respondWith()
            .statusCode(429)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.get("source_connection_id");
        }).rejects.toThrow(AirweaveSDK.TooManyRequestsError);
    });

    test("delete (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            id: "550e8400-e29b-41d4-a716-446655440000",
            organization_id: "123e4567-e89b-12d3-a456-426614174000",
            name: "GitHub Docs Repo",
            description: "Main documentation repository",
            short_name: "github",
            readable_collection_id: "documentation-ab123",
            status: "active",
            created_at: "2024-03-15T09:30:00Z",
            modified_at: "2024-03-15T14:22:15Z",
            auth: {
                method: "direct",
                authenticated: true,
                authenticated_at: "2024-03-15T09:30:00Z",
                expires_at: "2024-01-15T09:30:00Z",
                auth_url: "auth_url",
                auth_url_expires: "2024-01-15T09:30:00Z",
                redirect_url: "redirect_url",
                provider_readable_id: "provider_readable_id",
                provider_id: "provider_id",
            },
            config: { branch: "main", repo_name: "company/docs" },
            schedule: {
                cron: "0 */6 * * *",
                next_run: "2024-03-15T18:00:00Z",
                continuous: true,
                cursor_field: "cursor_field",
                cursor_value: { key: "value" },
            },
            sync: {
                total_runs: 15,
                successful_runs: 14,
                failed_runs: 1,
                last_job: {
                    id: "770e8400-e29b-41d4-a716-446655440002",
                    status: "created",
                    started_at: "2024-03-15T12:00:00Z",
                    completed_at: "2024-03-15T12:05:32Z",
                    duration_seconds: 332,
                    entities_inserted: 45,
                    entities_updated: 12,
                    entities_deleted: 1,
                    entities_failed: 1,
                    error: "error",
                },
            },
            sync_id: "sync_id",
            entities: { total_entities: 1250, by_type: { file: { count: 1250 } } },
            federated_search: false,
        };
        server
            .mockEndpoint()
            .delete("/source-connections/550e8400-e29b-41d4-a716-446655440000")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.sourceConnections.delete("550e8400-e29b-41d4-a716-446655440000");
        expect(response).toEqual({
            id: "550e8400-e29b-41d4-a716-446655440000",
            organization_id: "123e4567-e89b-12d3-a456-426614174000",
            name: "GitHub Docs Repo",
            description: "Main documentation repository",
            short_name: "github",
            readable_collection_id: "documentation-ab123",
            status: "active",
            created_at: "2024-03-15T09:30:00Z",
            modified_at: "2024-03-15T14:22:15Z",
            auth: {
                method: "direct",
                authenticated: true,
                authenticated_at: "2024-03-15T09:30:00Z",
                expires_at: "2024-01-15T09:30:00Z",
                auth_url: "auth_url",
                auth_url_expires: "2024-01-15T09:30:00Z",
                redirect_url: "redirect_url",
                provider_readable_id: "provider_readable_id",
                provider_id: "provider_id",
            },
            config: {
                branch: "main",
                repo_name: "company/docs",
            },
            schedule: {
                cron: "0 */6 * * *",
                next_run: "2024-03-15T18:00:00Z",
                continuous: true,
                cursor_field: "cursor_field",
                cursor_value: {
                    key: "value",
                },
            },
            sync: {
                total_runs: 15,
                successful_runs: 14,
                failed_runs: 1,
                last_job: {
                    id: "770e8400-e29b-41d4-a716-446655440002",
                    status: "created",
                    started_at: "2024-03-15T12:00:00Z",
                    completed_at: "2024-03-15T12:05:32Z",
                    duration_seconds: 332,
                    entities_inserted: 45,
                    entities_updated: 12,
                    entities_deleted: 1,
                    entities_failed: 1,
                    error: "error",
                },
            },
            sync_id: "sync_id",
            entities: {
                total_entities: 1250,
                by_type: {
                    file: {
                        count: 1250,
                    },
                },
            },
            federated_search: false,
        });
    });

    test("delete (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .delete("/source-connections/source_connection_id")
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.delete("source_connection_id");
        }).rejects.toThrow(AirweaveSDK.NotFoundError);
    });

    test("delete (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .delete("/source-connections/source_connection_id")
            .respondWith()
            .statusCode(422)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.delete("source_connection_id");
        }).rejects.toThrow(AirweaveSDK.UnprocessableEntityError);
    });

    test("delete (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .delete("/source-connections/source_connection_id")
            .respondWith()
            .statusCode(429)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.delete("source_connection_id");
        }).rejects.toThrow(AirweaveSDK.TooManyRequestsError);
    });

    test("update (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {};
        const rawResponseBody = {
            id: "550e8400-e29b-41d4-a716-446655440000",
            organization_id: "123e4567-e89b-12d3-a456-426614174000",
            name: "GitHub Docs Repo",
            description: "Main documentation repository",
            short_name: "github",
            readable_collection_id: "documentation-ab123",
            status: "active",
            created_at: "2024-03-15T09:30:00Z",
            modified_at: "2024-03-15T14:22:15Z",
            auth: {
                method: "direct",
                authenticated: true,
                authenticated_at: "2024-03-15T09:30:00Z",
                expires_at: "2024-01-15T09:30:00Z",
                auth_url: "auth_url",
                auth_url_expires: "2024-01-15T09:30:00Z",
                redirect_url: "redirect_url",
                provider_readable_id: "provider_readable_id",
                provider_id: "provider_id",
            },
            config: { branch: "main", repo_name: "company/docs" },
            schedule: {
                cron: "0 */6 * * *",
                next_run: "2024-03-15T18:00:00Z",
                continuous: true,
                cursor_field: "cursor_field",
                cursor_value: { key: "value" },
            },
            sync: {
                total_runs: 15,
                successful_runs: 14,
                failed_runs: 1,
                last_job: {
                    id: "770e8400-e29b-41d4-a716-446655440002",
                    status: "created",
                    started_at: "2024-03-15T12:00:00Z",
                    completed_at: "2024-03-15T12:05:32Z",
                    duration_seconds: 332,
                    entities_inserted: 45,
                    entities_updated: 12,
                    entities_deleted: 1,
                    entities_failed: 1,
                    error: "error",
                },
            },
            sync_id: "sync_id",
            entities: { total_entities: 1250, by_type: { file: { count: 1250 } } },
            federated_search: false,
        };
        server
            .mockEndpoint()
            .patch("/source-connections/550e8400-e29b-41d4-a716-446655440000")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.sourceConnections.update("550e8400-e29b-41d4-a716-446655440000");
        expect(response).toEqual({
            id: "550e8400-e29b-41d4-a716-446655440000",
            organization_id: "123e4567-e89b-12d3-a456-426614174000",
            name: "GitHub Docs Repo",
            description: "Main documentation repository",
            short_name: "github",
            readable_collection_id: "documentation-ab123",
            status: "active",
            created_at: "2024-03-15T09:30:00Z",
            modified_at: "2024-03-15T14:22:15Z",
            auth: {
                method: "direct",
                authenticated: true,
                authenticated_at: "2024-03-15T09:30:00Z",
                expires_at: "2024-01-15T09:30:00Z",
                auth_url: "auth_url",
                auth_url_expires: "2024-01-15T09:30:00Z",
                redirect_url: "redirect_url",
                provider_readable_id: "provider_readable_id",
                provider_id: "provider_id",
            },
            config: {
                branch: "main",
                repo_name: "company/docs",
            },
            schedule: {
                cron: "0 */6 * * *",
                next_run: "2024-03-15T18:00:00Z",
                continuous: true,
                cursor_field: "cursor_field",
                cursor_value: {
                    key: "value",
                },
            },
            sync: {
                total_runs: 15,
                successful_runs: 14,
                failed_runs: 1,
                last_job: {
                    id: "770e8400-e29b-41d4-a716-446655440002",
                    status: "created",
                    started_at: "2024-03-15T12:00:00Z",
                    completed_at: "2024-03-15T12:05:32Z",
                    duration_seconds: 332,
                    entities_inserted: 45,
                    entities_updated: 12,
                    entities_deleted: 1,
                    entities_failed: 1,
                    error: "error",
                },
            },
            sync_id: "sync_id",
            entities: {
                total_entities: 1250,
                by_type: {
                    file: {
                        count: 1250,
                    },
                },
            },
            federated_search: false,
        });
    });

    test("update (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {
            name: undefined,
            description: undefined,
            config: undefined,
            schedule: undefined,
            authentication: undefined,
        };
        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .patch("/source-connections/source_connection_id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.update("source_connection_id", {
                name: undefined,
                description: undefined,
                config: undefined,
                schedule: undefined,
                authentication: undefined,
            });
        }).rejects.toThrow(AirweaveSDK.NotFoundError);
    });

    test("update (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {
            name: undefined,
            description: undefined,
            config: undefined,
            schedule: undefined,
            authentication: undefined,
        };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .patch("/source-connections/source_connection_id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(422)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.update("source_connection_id", {
                name: undefined,
                description: undefined,
                config: undefined,
                schedule: undefined,
                authentication: undefined,
            });
        }).rejects.toThrow(AirweaveSDK.UnprocessableEntityError);
    });

    test("update (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {
            name: undefined,
            description: undefined,
            config: undefined,
            schedule: undefined,
            authentication: undefined,
        };
        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .patch("/source-connections/source_connection_id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(429)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.update("source_connection_id", {
                name: undefined,
                description: undefined,
                config: undefined,
                schedule: undefined,
                authentication: undefined,
            });
        }).rejects.toThrow(AirweaveSDK.TooManyRequestsError);
    });

    test("run (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            id: "770e8400-e29b-41d4-a716-446655440002",
            source_connection_id: "550e8400-e29b-41d4-a716-446655440000",
            status: "created",
            started_at: "2024-03-15T12:00:00Z",
            completed_at: "2024-03-15T12:05:32Z",
            duration_seconds: 332.5,
            entities_inserted: 45,
            entities_updated: 12,
            entities_deleted: 3,
            entities_failed: 0,
            error: "error",
            error_details: { key: "value" },
        };
        server
            .mockEndpoint()
            .post("/source-connections/550e8400-e29b-41d4-a716-446655440000/run")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.sourceConnections.run("550e8400-e29b-41d4-a716-446655440000", {
            force_full_sync: false,
        });
        expect(response).toEqual({
            id: "770e8400-e29b-41d4-a716-446655440002",
            source_connection_id: "550e8400-e29b-41d4-a716-446655440000",
            status: "created",
            started_at: "2024-03-15T12:00:00Z",
            completed_at: "2024-03-15T12:05:32Z",
            duration_seconds: 332.5,
            entities_inserted: 45,
            entities_updated: 12,
            entities_deleted: 3,
            entities_failed: 0,
            error: "error",
            error_details: {
                key: "value",
            },
        });
    });

    test("run (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .post("/source-connections/source_connection_id/run")
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.run("source_connection_id");
        }).rejects.toThrow(AirweaveSDK.NotFoundError);
    });

    test("run (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .post("/source-connections/source_connection_id/run")
            .respondWith()
            .statusCode(409)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.run("source_connection_id");
        }).rejects.toThrow(AirweaveSDK.ConflictError);
    });

    test("run (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/source-connections/source_connection_id/run")
            .respondWith()
            .statusCode(422)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.run("source_connection_id");
        }).rejects.toThrow(AirweaveSDK.UnprocessableEntityError);
    });

    test("run (5)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .post("/source-connections/source_connection_id/run")
            .respondWith()
            .statusCode(429)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.run("source_connection_id");
        }).rejects.toThrow(AirweaveSDK.TooManyRequestsError);
    });

    test("getSourceConnectionJobs (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = [
            {
                id: "770e8400-e29b-41d4-a716-446655440002",
                source_connection_id: "550e8400-e29b-41d4-a716-446655440000",
                status: "created",
                started_at: "2024-03-15T12:00:00Z",
                completed_at: "2024-03-15T12:05:32Z",
                duration_seconds: 332.5,
                entities_inserted: 45,
                entities_updated: 12,
                entities_deleted: 3,
                entities_failed: 0,
                error: "error",
                error_details: { key: "value" },
            },
        ];
        server
            .mockEndpoint()
            .get("/source-connections/550e8400-e29b-41d4-a716-446655440000/jobs")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.sourceConnections.getSourceConnectionJobs(
            "550e8400-e29b-41d4-a716-446655440000",
            {
                limit: 100,
            },
        );
        expect(response).toEqual([
            {
                id: "770e8400-e29b-41d4-a716-446655440002",
                source_connection_id: "550e8400-e29b-41d4-a716-446655440000",
                status: "created",
                started_at: "2024-03-15T12:00:00Z",
                completed_at: "2024-03-15T12:05:32Z",
                duration_seconds: 332.5,
                entities_inserted: 45,
                entities_updated: 12,
                entities_deleted: 3,
                entities_failed: 0,
                error: "error",
                error_details: {
                    key: "value",
                },
            },
        ]);
    });

    test("getSourceConnectionJobs (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .get("/source-connections/source_connection_id/jobs")
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.getSourceConnectionJobs("source_connection_id");
        }).rejects.toThrow(AirweaveSDK.NotFoundError);
    });

    test("getSourceConnectionJobs (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .get("/source-connections/source_connection_id/jobs")
            .respondWith()
            .statusCode(422)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.getSourceConnectionJobs("source_connection_id");
        }).rejects.toThrow(AirweaveSDK.UnprocessableEntityError);
    });

    test("getSourceConnectionJobs (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .get("/source-connections/source_connection_id/jobs")
            .respondWith()
            .statusCode(429)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.getSourceConnectionJobs("source_connection_id");
        }).rejects.toThrow(AirweaveSDK.TooManyRequestsError);
    });

    test("cancelJob (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            id: "770e8400-e29b-41d4-a716-446655440002",
            source_connection_id: "550e8400-e29b-41d4-a716-446655440000",
            status: "created",
            started_at: "2024-03-15T12:00:00Z",
            completed_at: "2024-03-15T12:05:32Z",
            duration_seconds: 332.5,
            entities_inserted: 45,
            entities_updated: 12,
            entities_deleted: 3,
            entities_failed: 0,
            error: "error",
            error_details: { key: "value" },
        };
        server
            .mockEndpoint()
            .post(
                "/source-connections/550e8400-e29b-41d4-a716-446655440000/jobs/660e8400-e29b-41d4-a716-446655440001/cancel",
            )
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.sourceConnections.cancelJob(
            "550e8400-e29b-41d4-a716-446655440000",
            "660e8400-e29b-41d4-a716-446655440001",
        );
        expect(response).toEqual({
            id: "770e8400-e29b-41d4-a716-446655440002",
            source_connection_id: "550e8400-e29b-41d4-a716-446655440000",
            status: "created",
            started_at: "2024-03-15T12:00:00Z",
            completed_at: "2024-03-15T12:05:32Z",
            duration_seconds: 332.5,
            entities_inserted: 45,
            entities_updated: 12,
            entities_deleted: 3,
            entities_failed: 0,
            error: "error",
            error_details: {
                key: "value",
            },
        });
    });

    test("cancelJob (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .post("/source-connections/source_connection_id/jobs/job_id/cancel")
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.cancelJob("source_connection_id", "job_id");
        }).rejects.toThrow(AirweaveSDK.NotFoundError);
    });

    test("cancelJob (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .post("/source-connections/source_connection_id/jobs/job_id/cancel")
            .respondWith()
            .statusCode(409)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.cancelJob("source_connection_id", "job_id");
        }).rejects.toThrow(AirweaveSDK.ConflictError);
    });

    test("cancelJob (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/source-connections/source_connection_id/jobs/job_id/cancel")
            .respondWith()
            .statusCode(422)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.cancelJob("source_connection_id", "job_id");
        }).rejects.toThrow(AirweaveSDK.UnprocessableEntityError);
    });

    test("cancelJob (5)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .post("/source-connections/source_connection_id/jobs/job_id/cancel")
            .respondWith()
            .statusCode(429)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.sourceConnections.cancelJob("source_connection_id", "job_id");
        }).rejects.toThrow(AirweaveSDK.TooManyRequestsError);
    });
});
