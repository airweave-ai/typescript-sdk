/**
 * This file was auto-generated by Fern from our API Definition.
 */

import { mockServerPool } from "../mock-server/MockServerPool";
import { AirweaveSDKClient } from "../../src/Client";
import * as AirweaveSDK from "../../src/api/index";

describe("Webhooks", () => {
    test("getMessages (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = [
            {
                id: "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                event_type: "sync.completed",
                payload: {
                    event_type: "sync.completed",
                    job_id: "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                    collection_readable_id: "customer-support-tickets-x7k9m",
                    collection_name: "Customer Support Tickets",
                    source_type: "zendesk",
                    status: "completed",
                    timestamp: "2024-03-15T09:45:32Z",
                    source_connection_id: "b2c3d4e5-f6a7-8901-bcde-f23456789012",
                    error: "error",
                },
                timestamp: "2024-03-15T09:45:32Z",
                channels: ["sync.completed"],
                tags: ["tags"],
            },
        ];
        server.mockEndpoint().get("/webhooks/messages").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.webhooks.getMessages();
        expect(response).toEqual([
            {
                id: "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                event_type: "sync.completed",
                payload: {
                    event_type: "sync.completed",
                    job_id: "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                    collection_readable_id: "customer-support-tickets-x7k9m",
                    collection_name: "Customer Support Tickets",
                    source_type: "zendesk",
                    status: "completed",
                    timestamp: "2024-03-15T09:45:32Z",
                    source_connection_id: "b2c3d4e5-f6a7-8901-bcde-f23456789012",
                    error: "error",
                },
                timestamp: "2024-03-15T09:45:32Z",
                channels: ["sync.completed"],
                tags: ["tags"],
            },
        ]);
    });

    test("getMessages (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().get("/webhooks/messages").respondWith().statusCode(422).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.webhooks.getMessages();
        }).rejects.toThrow(AirweaveSDK.UnprocessableEntityError);
    });

    test("getMessages (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { detail: "detail" };
        server.mockEndpoint().get("/webhooks/messages").respondWith().statusCode(429).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.webhooks.getMessages();
        }).rejects.toThrow(AirweaveSDK.TooManyRequestsError);
    });

    test("getMessage (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            id: "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
            event_type: "sync.completed",
            payload: {
                event_type: "sync.completed",
                job_id: "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                collection_readable_id: "customer-support-tickets-x7k9m",
                collection_name: "Customer Support Tickets",
                source_type: "zendesk",
                status: "completed",
                timestamp: "2024-03-15T09:45:32Z",
                source_connection_id: "b2c3d4e5-f6a7-8901-bcde-f23456789012",
                error: "error",
            },
            timestamp: "2024-03-15T09:45:32Z",
            channels: ["sync.completed"],
            tags: ["tags"],
            delivery_attempts: [
                {
                    id: "atmpt_2bVxUn3RFnLYHa8z6ZKHMT9PqPX",
                    message_id: "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                    endpoint_id: "c3d4e5f6-a7b8-9012-cdef-345678901234",
                    response: "response",
                    response_status_code: 200,
                    status: "success",
                    timestamp: "2024-03-15T09:45:33Z",
                    url: "url",
                },
            ],
        };
        server
            .mockEndpoint()
            .get("/webhooks/messages/550e8400-e29b-41d4-a716-446655440000")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.webhooks.getMessage("550e8400-e29b-41d4-a716-446655440000", {
            include_attempts: true,
        });
        expect(response).toEqual({
            id: "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
            event_type: "sync.completed",
            payload: {
                event_type: "sync.completed",
                job_id: "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                collection_readable_id: "customer-support-tickets-x7k9m",
                collection_name: "Customer Support Tickets",
                source_type: "zendesk",
                status: "completed",
                timestamp: "2024-03-15T09:45:32Z",
                source_connection_id: "b2c3d4e5-f6a7-8901-bcde-f23456789012",
                error: "error",
            },
            timestamp: "2024-03-15T09:45:32Z",
            channels: ["sync.completed"],
            tags: ["tags"],
            delivery_attempts: [
                {
                    id: "atmpt_2bVxUn3RFnLYHa8z6ZKHMT9PqPX",
                    message_id: "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                    endpoint_id: "c3d4e5f6-a7b8-9012-cdef-345678901234",
                    response: "response",
                    response_status_code: 200,
                    status: "success",
                    timestamp: "2024-03-15T09:45:33Z",
                    url: "url",
                },
            ],
        });
    });

    test("getMessage (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .get("/webhooks/messages/message_id")
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.webhooks.getMessage("message_id");
        }).rejects.toThrow(AirweaveSDK.NotFoundError);
    });

    test("getMessage (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .get("/webhooks/messages/message_id")
            .respondWith()
            .statusCode(422)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.webhooks.getMessage("message_id");
        }).rejects.toThrow(AirweaveSDK.UnprocessableEntityError);
    });

    test("getMessage (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .get("/webhooks/messages/message_id")
            .respondWith()
            .statusCode(429)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.webhooks.getMessage("message_id");
        }).rejects.toThrow(AirweaveSDK.TooManyRequestsError);
    });

    test("getSubscriptions (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = [
            {
                id: "c3d4e5f6-a7b8-9012-cdef-345678901234",
                url: "https://api.mycompany.com/webhooks/airweave",
                filter_types: ["sync.completed", "sync.failed"],
                disabled: false,
                description: "Production notifications for data team",
                created_at: "2024-03-01T08:00:00Z",
                updated_at: "2024-03-15T14:30:00Z",
                delivery_attempts: [
                    {
                        id: "atmpt_2bVxUn3RFnLYHa8z6ZKHMT9PqPX",
                        message_id: "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                        endpoint_id: "c3d4e5f6-a7b8-9012-cdef-345678901234",
                        response_status_code: 200,
                        status: "success",
                        timestamp: "2024-03-15T09:45:33Z",
                    },
                ],
                secret: "secret",
            },
        ];
        server
            .mockEndpoint()
            .get("/webhooks/subscriptions")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.webhooks.getSubscriptions();
        expect(response).toEqual([
            {
                id: "c3d4e5f6-a7b8-9012-cdef-345678901234",
                url: "https://api.mycompany.com/webhooks/airweave",
                filter_types: ["sync.completed", "sync.failed"],
                disabled: false,
                description: "Production notifications for data team",
                created_at: "2024-03-01T08:00:00Z",
                updated_at: "2024-03-15T14:30:00Z",
                delivery_attempts: [
                    {
                        id: "atmpt_2bVxUn3RFnLYHa8z6ZKHMT9PqPX",
                        message_id: "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                        endpoint_id: "c3d4e5f6-a7b8-9012-cdef-345678901234",
                        response_status_code: 200,
                        status: "success",
                        timestamp: "2024-03-15T09:45:33Z",
                    },
                ],
                secret: "secret",
            },
        ]);
    });

    test("getSubscriptions (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .get("/webhooks/subscriptions")
            .respondWith()
            .statusCode(422)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.webhooks.getSubscriptions();
        }).rejects.toThrow(AirweaveSDK.UnprocessableEntityError);
    });

    test("getSubscriptions (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .get("/webhooks/subscriptions")
            .respondWith()
            .statusCode(429)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.webhooks.getSubscriptions();
        }).rejects.toThrow(AirweaveSDK.TooManyRequestsError);
    });

    test("createSubscription (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {
            url: "https://api.mycompany.com/webhooks/airweave",
            event_types: ["sync.completed", "sync.failed"],
        };
        const rawResponseBody = {
            id: "c3d4e5f6-a7b8-9012-cdef-345678901234",
            url: "https://api.mycompany.com/webhooks/airweave",
            filter_types: ["sync.completed", "sync.failed"],
            disabled: false,
            description: "Production notifications for data team",
            created_at: "2024-03-01T08:00:00Z",
            updated_at: "2024-03-15T14:30:00Z",
            delivery_attempts: [
                {
                    id: "atmpt_2bVxUn3RFnLYHa8z6ZKHMT9PqPX",
                    message_id: "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                    endpoint_id: "c3d4e5f6-a7b8-9012-cdef-345678901234",
                    response: "response",
                    response_status_code: 200,
                    status: "success",
                    timestamp: "2024-03-15T09:45:33Z",
                    url: "url",
                },
            ],
            secret: "secret",
        };
        server
            .mockEndpoint()
            .post("/webhooks/subscriptions")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.webhooks.createSubscription({
            url: "https://api.mycompany.com/webhooks/airweave",
            event_types: ["sync.completed", "sync.failed"],
        });
        expect(response).toEqual({
            id: "c3d4e5f6-a7b8-9012-cdef-345678901234",
            url: "https://api.mycompany.com/webhooks/airweave",
            filter_types: ["sync.completed", "sync.failed"],
            disabled: false,
            description: "Production notifications for data team",
            created_at: "2024-03-01T08:00:00Z",
            updated_at: "2024-03-15T14:30:00Z",
            delivery_attempts: [
                {
                    id: "atmpt_2bVxUn3RFnLYHa8z6ZKHMT9PqPX",
                    message_id: "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                    endpoint_id: "c3d4e5f6-a7b8-9012-cdef-345678901234",
                    response: "response",
                    response_status_code: 200,
                    status: "success",
                    timestamp: "2024-03-15T09:45:33Z",
                    url: "url",
                },
            ],
            secret: "secret",
        });
    });

    test("createSubscription (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { url: "x", event_types: ["sync.pending", "sync.pending"], secret: undefined };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/webhooks/subscriptions")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(422)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.webhooks.createSubscription({
                url: "x",
                event_types: ["sync.pending", "sync.pending"],
                secret: undefined,
            });
        }).rejects.toThrow(AirweaveSDK.UnprocessableEntityError);
    });

    test("createSubscription (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { url: "x", event_types: ["sync.pending", "sync.pending"], secret: undefined };
        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .post("/webhooks/subscriptions")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(429)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.webhooks.createSubscription({
                url: "x",
                event_types: ["sync.pending", "sync.pending"],
                secret: undefined,
            });
        }).rejects.toThrow(AirweaveSDK.TooManyRequestsError);
    });

    test("getSubscription (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            id: "c3d4e5f6-a7b8-9012-cdef-345678901234",
            url: "https://api.mycompany.com/webhooks/airweave",
            filter_types: ["sync.completed", "sync.failed"],
            disabled: false,
            description: "Production notifications for data team",
            created_at: "2024-03-01T08:00:00Z",
            updated_at: "2024-03-15T14:30:00Z",
            delivery_attempts: [
                {
                    id: "atmpt_2bVxUn3RFnLYHa8z6ZKHMT9PqPX",
                    message_id: "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                    endpoint_id: "c3d4e5f6-a7b8-9012-cdef-345678901234",
                    response: "response",
                    response_status_code: 200,
                    status: "success",
                    timestamp: "2024-03-15T09:45:33Z",
                    url: "url",
                },
            ],
            secret: "secret",
        };
        server
            .mockEndpoint()
            .get("/webhooks/subscriptions/550e8400-e29b-41d4-a716-446655440000")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.webhooks.getSubscription("550e8400-e29b-41d4-a716-446655440000", {
            include_secret: true,
        });
        expect(response).toEqual({
            id: "c3d4e5f6-a7b8-9012-cdef-345678901234",
            url: "https://api.mycompany.com/webhooks/airweave",
            filter_types: ["sync.completed", "sync.failed"],
            disabled: false,
            description: "Production notifications for data team",
            created_at: "2024-03-01T08:00:00Z",
            updated_at: "2024-03-15T14:30:00Z",
            delivery_attempts: [
                {
                    id: "atmpt_2bVxUn3RFnLYHa8z6ZKHMT9PqPX",
                    message_id: "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                    endpoint_id: "c3d4e5f6-a7b8-9012-cdef-345678901234",
                    response: "response",
                    response_status_code: 200,
                    status: "success",
                    timestamp: "2024-03-15T09:45:33Z",
                    url: "url",
                },
            ],
            secret: "secret",
        });
    });

    test("getSubscription (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .get("/webhooks/subscriptions/subscription_id")
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.webhooks.getSubscription("subscription_id");
        }).rejects.toThrow(AirweaveSDK.NotFoundError);
    });

    test("getSubscription (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .get("/webhooks/subscriptions/subscription_id")
            .respondWith()
            .statusCode(422)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.webhooks.getSubscription("subscription_id");
        }).rejects.toThrow(AirweaveSDK.UnprocessableEntityError);
    });

    test("getSubscription (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .get("/webhooks/subscriptions/subscription_id")
            .respondWith()
            .statusCode(429)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.webhooks.getSubscription("subscription_id");
        }).rejects.toThrow(AirweaveSDK.TooManyRequestsError);
    });

    test("deleteSubscription (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = {
            id: "c3d4e5f6-a7b8-9012-cdef-345678901234",
            url: "https://api.mycompany.com/webhooks/airweave",
            filter_types: ["sync.completed", "sync.failed"],
            disabled: false,
            description: "Production notifications for data team",
            created_at: "2024-03-01T08:00:00Z",
            updated_at: "2024-03-15T14:30:00Z",
            delivery_attempts: [
                {
                    id: "atmpt_2bVxUn3RFnLYHa8z6ZKHMT9PqPX",
                    message_id: "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                    endpoint_id: "c3d4e5f6-a7b8-9012-cdef-345678901234",
                    response: "response",
                    response_status_code: 200,
                    status: "success",
                    timestamp: "2024-03-15T09:45:33Z",
                    url: "url",
                },
            ],
            secret: "secret",
        };
        server
            .mockEndpoint()
            .delete("/webhooks/subscriptions/550e8400-e29b-41d4-a716-446655440000")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.webhooks.deleteSubscription("550e8400-e29b-41d4-a716-446655440000");
        expect(response).toEqual({
            id: "c3d4e5f6-a7b8-9012-cdef-345678901234",
            url: "https://api.mycompany.com/webhooks/airweave",
            filter_types: ["sync.completed", "sync.failed"],
            disabled: false,
            description: "Production notifications for data team",
            created_at: "2024-03-01T08:00:00Z",
            updated_at: "2024-03-15T14:30:00Z",
            delivery_attempts: [
                {
                    id: "atmpt_2bVxUn3RFnLYHa8z6ZKHMT9PqPX",
                    message_id: "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                    endpoint_id: "c3d4e5f6-a7b8-9012-cdef-345678901234",
                    response: "response",
                    response_status_code: 200,
                    status: "success",
                    timestamp: "2024-03-15T09:45:33Z",
                    url: "url",
                },
            ],
            secret: "secret",
        });
    });

    test("deleteSubscription (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .delete("/webhooks/subscriptions/subscription_id")
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.webhooks.deleteSubscription("subscription_id");
        }).rejects.toThrow(AirweaveSDK.NotFoundError);
    });

    test("deleteSubscription (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .delete("/webhooks/subscriptions/subscription_id")
            .respondWith()
            .statusCode(422)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.webhooks.deleteSubscription("subscription_id");
        }).rejects.toThrow(AirweaveSDK.UnprocessableEntityError);
    });

    test("deleteSubscription (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });

        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .delete("/webhooks/subscriptions/subscription_id")
            .respondWith()
            .statusCode(429)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.webhooks.deleteSubscription("subscription_id");
        }).rejects.toThrow(AirweaveSDK.TooManyRequestsError);
    });

    test("patchSubscription (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {};
        const rawResponseBody = {
            id: "c3d4e5f6-a7b8-9012-cdef-345678901234",
            url: "https://api.mycompany.com/webhooks/airweave",
            filter_types: ["sync.completed", "sync.failed"],
            disabled: false,
            description: "Production notifications for data team",
            created_at: "2024-03-01T08:00:00Z",
            updated_at: "2024-03-15T14:30:00Z",
            delivery_attempts: [
                {
                    id: "atmpt_2bVxUn3RFnLYHa8z6ZKHMT9PqPX",
                    message_id: "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                    endpoint_id: "c3d4e5f6-a7b8-9012-cdef-345678901234",
                    response: "response",
                    response_status_code: 200,
                    status: "success",
                    timestamp: "2024-03-15T09:45:33Z",
                    url: "url",
                },
            ],
            secret: "secret",
        };
        server
            .mockEndpoint()
            .patch("/webhooks/subscriptions/550e8400-e29b-41d4-a716-446655440000")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.webhooks.patchSubscription("550e8400-e29b-41d4-a716-446655440000");
        expect(response).toEqual({
            id: "c3d4e5f6-a7b8-9012-cdef-345678901234",
            url: "https://api.mycompany.com/webhooks/airweave",
            filter_types: ["sync.completed", "sync.failed"],
            disabled: false,
            description: "Production notifications for data team",
            created_at: "2024-03-01T08:00:00Z",
            updated_at: "2024-03-15T14:30:00Z",
            delivery_attempts: [
                {
                    id: "atmpt_2bVxUn3RFnLYHa8z6ZKHMT9PqPX",
                    message_id: "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
                    endpoint_id: "c3d4e5f6-a7b8-9012-cdef-345678901234",
                    response: "response",
                    response_status_code: 200,
                    status: "success",
                    timestamp: "2024-03-15T09:45:33Z",
                    url: "url",
                },
            ],
            secret: "secret",
        });
    });

    test("patchSubscription (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {
            url: undefined,
            event_types: undefined,
            disabled: undefined,
            recover_since: undefined,
        };
        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .patch("/webhooks/subscriptions/subscription_id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.webhooks.patchSubscription("subscription_id", {
                url: undefined,
                event_types: undefined,
                disabled: undefined,
                recover_since: undefined,
            });
        }).rejects.toThrow(AirweaveSDK.NotFoundError);
    });

    test("patchSubscription (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {
            url: undefined,
            event_types: undefined,
            disabled: undefined,
            recover_since: undefined,
        };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .patch("/webhooks/subscriptions/subscription_id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(422)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.webhooks.patchSubscription("subscription_id", {
                url: undefined,
                event_types: undefined,
                disabled: undefined,
                recover_since: undefined,
            });
        }).rejects.toThrow(AirweaveSDK.UnprocessableEntityError);
    });

    test("patchSubscription (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = {
            url: undefined,
            event_types: undefined,
            disabled: undefined,
            recover_since: undefined,
        };
        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .patch("/webhooks/subscriptions/subscription_id")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(429)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.webhooks.patchSubscription("subscription_id", {
                url: undefined,
                event_types: undefined,
                disabled: undefined,
                recover_since: undefined,
            });
        }).rejects.toThrow(AirweaveSDK.TooManyRequestsError);
    });

    test("recoverFailedMessages (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { since: "2024-03-14T00:00:00Z" };
        const rawResponseBody = { id: "rcvr_2bVxUn3RFnLYHa8z6ZKHMT9PqPX", status: "running" };
        server
            .mockEndpoint()
            .post("/webhooks/subscriptions/550e8400-e29b-41d4-a716-446655440000/recover")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.webhooks.recoverFailedMessages("550e8400-e29b-41d4-a716-446655440000", {
            since: "2024-03-14T00:00:00Z",
        });
        expect(response).toEqual({
            id: "rcvr_2bVxUn3RFnLYHa8z6ZKHMT9PqPX",
            status: "running",
        });
    });

    test("recoverFailedMessages (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { since: "2024-01-15T09:30:00Z", until: undefined };
        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .post("/webhooks/subscriptions/subscription_id/recover")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.webhooks.recoverFailedMessages("subscription_id", {
                since: "2024-01-15T09:30:00Z",
                until: undefined,
            });
        }).rejects.toThrow(AirweaveSDK.NotFoundError);
    });

    test("recoverFailedMessages (3)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { since: "2024-01-15T09:30:00Z", until: undefined };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/webhooks/subscriptions/subscription_id/recover")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(422)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.webhooks.recoverFailedMessages("subscription_id", {
                since: "2024-01-15T09:30:00Z",
                until: undefined,
            });
        }).rejects.toThrow(AirweaveSDK.UnprocessableEntityError);
    });

    test("recoverFailedMessages (4)", async () => {
        const server = mockServerPool.createServer();
        const client = new AirweaveSDKClient({ apiKey: "test", environment: server.baseUrl });
        const rawRequestBody = { since: "2024-01-15T09:30:00Z", until: undefined };
        const rawResponseBody = { detail: "detail" };
        server
            .mockEndpoint()
            .post("/webhooks/subscriptions/subscription_id/recover")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(429)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.webhooks.recoverFailedMessages("subscription_id", {
                since: "2024-01-15T09:30:00Z",
                until: undefined,
            });
        }).rejects.toThrow(AirweaveSDK.TooManyRequestsError);
    });
});
